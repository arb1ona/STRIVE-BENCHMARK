<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../styles/main.css" />
    <link />
    <title>Fakeflix</title>
    <style>
      .card:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2),
          0 6px 8px 0 rgba(0, 0, 0, 0.19);
        z-index: 2;
      }
      .card img {
        object-fit: contain;
      }

      .form-control:focus {
        border: 1px solid #ced4da !important;
        outline: none !important;
        box-shadow: none !important;
      }
      .spinner-border {
        margin-top: 200px;
        padding: 120px;
      }
      .shopIcon {
        float: right;
        font-size: 50px;
        position: sticky;
        padding-right: 20px;
        padding-bottom: 20px;
        right: 0;
        bottom: 0;
      }
      .shopCart {
        position: absolute;
        top: 50%;
        left: 50%;
        z-index: 3;
        margin-top: -150px;
        margin-left: -200px;
        background-color: whitesmoke;
      }
    </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-black-to-transparent">
      <a class="navbar-brand" href="/">
        <img id="logo" src="../assets/logo/logo.png" />
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/browse/"
              >Home <span class="sr-only">(current)</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/browse/tv/">Tv Shows</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/browse/movies/">Movies</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/browse/latest/">Latest</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/browse/backoffice/">Backoffice</a>
          </li>
        </ul>
        <ul class="navbar-nav md-auto">
          <li class="nav-item active">
            <button class="btn btn-icon">
              <svg
                class="bi btn-icon"
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                />
              </svg>
            </button>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="#">KIDS</a>
          </li>
          <li class="nav-item active">
            <button class="btn btn-icon">
              <svg
                class="bi bi-gift-fill"
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 1a1.5 1.5 0 0 0-1.5 1.5c0 .098.033.16.12.227.103.081.272.15.49.2A3.44 3.44 0 0 0 9.96 3h.015L10 2.999l.025.002h.014A2.569 2.569 0 0 0 10.293 3c.17-.006.387-.026.598-.073.217-.048.386-.118.49-.199.086-.066.119-.13.119-.227A1.5 1.5 0 0 0 10 1zm0 3h-.006a3.535 3.535 0 0 1-.326 0 4.435 4.435 0 0 1-.777-.097c-.283-.063-.614-.175-.885-.385A1.255 1.255 0 0 1 7.5 2.5a2.5 2.5 0 0 1 5 0c0 .454-.217.793-.506 1.017-.27.21-.602.322-.885.385a4.434 4.434 0 0 1-1.104.099H10z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6 1a1.5 1.5 0 0 0-1.5 1.5c0 .098.033.16.12.227.103.081.272.15.49.2A3.44 3.44 0 0 0 5.96 3h.015L6 2.999l.025.002h.014l.053.001a3.869 3.869 0 0 0 .799-.076c.217-.048.386-.118.49-.199.086-.066.119-.13.119-.227A1.5 1.5 0 0 0 6 1zm0 3h-.006a3.535 3.535 0 0 1-.326 0 4.435 4.435 0 0 1-.777-.097c-.283-.063-.614-.175-.885-.385A1.255 1.255 0 0 1 3.5 2.5a2.5 2.5 0 0 1 5 0c0 .454-.217.793-.506 1.017-.27.21-.602.322-.885.385a4.435 4.435 0 0 1-1.103.099H6zm9 10.5V7H8.5v9h5a1.5 1.5 0 0 0 1.5-1.5zM7.5 16h-5A1.5 1.5 0 0 1 1 14.5V7h6.5v9z"
                />
                <path
                  d="M0 4a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V4z"
                />
              </svg>
            </button>
          </li>
          <li class="nav-item active">
            <button class="btn btn-icon">
              <svg
                class="bi bi-bell-fill"
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z"
                />
              </svg>
            </button>
          </li>

          <li class="nav-item active">
            <div class="dropdown">
              <button
                class="btn dropdown-toggle"
                type="button"
                id="dropdownMenuButton"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <img
                  class="avatar-small"
                  src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/bf6e4a33850498.56ba69ac3064f.png"
                />
              </button>
              <div
                class="dropdown-menu dropdown-menu-right"
                aria-labelledby="dropdownMenuButton"
              >
                <a class="dropdown-item" href="#">
                  <img
                    src="https://occ-0-2774-2773.1.nflxso.net/dnm/api/v6/Z-WHgqd_TeJxSuha8aZ5WpyLcX8/AAAABStzLDeGj7bWmoD-O6QNHNNdD5Ad2QavsgcT21Boh5v59XU7diRydZx-0vmiJ4TmtnVhIauxkY8zhmXswRH4eCg.png?r=fcd"
                  />
                  <span>Kids</span>
                </a>
                <a class="dropdown-item" href="#">Manage Profiles</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Account</a>
                <a class="dropdown-item" href="#">Help center</a>
                <a class="dropdown-item" href="#">Sign out of Fakeflix</a>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <!------------- THE END OF NAVBAR----------------------->

    <!-------------------THE MAIN------------------->

    <div class="container-fluid">
      <div class="container">
        <div
          id="products"
          class="row row-cols-2 row-cols-md-4 row-cols-lg-5 d-flex justify-content-center mb-5 mt-5"
        >
          <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </div>
      </div>
    </div>
    <div class="shopIcon d-none">
      <button
        type="button"
        id="cartIcon"
        style="border: 0; background-color: transparent;"
        data-toggle="modal"
        data-target="#userCart"
      >
        <i class="fa fa-shopping-cart"></i>
      </button>
    </div>
    <div class="shopCart d-none">
      <div>
        <table id="table">
          <tr>
            <th style="padding: 10px;">Name</th>
            <th style="padding: 10px;">Brand</th>
            <th>Price</th>
          </tr>
        </table>
      </div>
    </div>

    <!----------------THE END OF MAIN---------------->

    <script src="/helpers/functions.js"></script>

    <script>
      let id;
      window.onload = async () => {
        id = new URLSearchParams(document.location.search).get("id");
        var reference = document.querySelector("#products");
        let data = await getData();
        var products = [];
        let spinner = document.querySelector(".spinner-border");
        spinner.classList.toggle("d-none");
        for (let i = 0; i < data.length; i++) {
          products.push(data[i]);
          reference.innerHTML += `
              <div class="col text-center mb-3 mr-3">
                  <div class="card" style="width: 12rem; border:0; font-size:12px;">
                      <a href="productDetails.html?id=${
                        data[i]._id
                      }"><img src=${
            data[i].imageUrl
          } class="card-img-top" height="250px" alt=${data[i].name} photo></a>
                      <div class="card-body flex-direction-column">
                          <h6 class="card-title">${data[i].name}</h6>
                          <p class="card-text">${data[i].description.slice(
                            0,
                            40
                          )}...</p>
                          <p class="card-text">Brand: ${data[i].brand}</p>
                          <h6 class="card-title">Price: ${data[i].price} $</h6>
                          </div>
                  </div>
              </div>
              `;
        }
        filterProducts = () => {
          let userInput = document
            .querySelector("#userInput")
            .value.toLowerCase();
          let array = products.filter((product) =>
            product.name.toLowerCase().includes(userInput)
          );
          if (userInput.length > 0) {
            reference.innerHTML = "";
            for (let i = 0; i < array.length; i++) {
              reference.innerHTML += `
                  <div class="col text-center mb-3 mr-3">
                      <div class="card" style="width: 12rem; border:0; font-size:12px;">
                          <a href="productDetails.html?id=${
                            array[i]._id
                          }"><img src=${
                array[i].imageUrl
              } class="card-img-top" height="250px" alt=${
                array[i].name
              } photo></a>
                          <div class="card-body flex-direction-column">
                              <h6 class="card-title">${array[i].name}</h6>
                              <p class="card-text">${array[i].description.slice(
                                0,
                                40
                              )}...</p>
                              <p class="card-text">Brand: ${array[i].brand}</p>
                              <h6 class="card-title">Price: ${
                                array[i].price
                              } $</h6>
                              </div>
                      </div>
                  </div>
                  `;
            }
          } else {
            reference.innerHTML = "";
            for (let i = 1; i < data.length; i++) {
              reference.innerHTML += `
                      <div class="col text-center mb-3 mr-3">
                          <div class="card" style="width: 12rem; border:0; font-size:12px;">
                              <a href="productDetails.html?id=${
                                data[i]._id
                              }"><img src=${
                data[i].imageUrl
              } class="card-img-top" height="250px" alt=${
                data[i].name
              } photo></a>
                              <div class="card-body flex-direction-column">
                                  <h6 class="card-title">${data[i].name}</h6>
                                  <p class="card-text">${data[
                                    i
                                  ].description.slice(0, 40)}...</p>
                                  <p class="card-text">Brand: ${
                                    data[i].brand
                                  }</p>
                                  <h6 class="card-title">Price: ${
                                    data[i].price
                                  } $</h6>
                                  </div>
                          </div>
                      </div>
                      `;
            }
          }
        };
      };
    </script>

    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
